(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{342:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(48),c=n(29),l=n(690),s=n(297),i=n(691),u=n(682),m=n(21),p=n.n(m),d=n(344),f=n(1),g=n.n(f),h=(n(640),n(157)),b=n.n(h),y=n(4),O=n(358),E=n.n(O),j=n(94),w=n.n(j),k=n(54),v=n.n(k),C=n(134),S=n.n(C),I=n(650),P=n.n(I);n(346),n(141),n(140),n(153),n(642);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done)&&(n.push(c.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var R=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(8),n.e(13)]).then(n.bind(null,402))})),D=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(16)]).then(n.bind(null,399))})),F=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(15),n.e(17)]).then(n.bind(null,669))})),L=P.a.Meta,z=function(e){var t=e.post,n=B(Object(a.useState)(!1),2),m=n[0],f=n[1],g=B(Object(a.useState)(!1),2),h=g[0],O=g[1],j=B(Object(a.useState)(0),2),k=j[0],C=j[1],I=B(Object(a.useState)(!1),2),A=I[0],q=I[1],M=B(Object(a.useState)(!1),2),z=M[0],T=M[1],J=Object(o.c)((function(e){return e})).userInfo,U=Object(o.b)(),H=Object(c.f)(),N=null,$=[],_=[];Object(a.useEffect)((function(){f(!1),O(!1)}),[J&&J.username,t.data.comments.length,t.data.updated_at]);var G=Object(a.useCallback)((function(e){console.log("hashtag: ",e),U({type:y.m}),U({type:y.q,payload:{hashtag:e}}),window.scrollTo(0,0),H.push("/hashtag")}),[]),K=Object(a.useCallback)((function(){return!(!J||!J.username)||(w.a.warning("Login Please! 😱"),!1)}),[J]),Q=Object(a.useCallback)((function(e){console.log(e.target.alt),C(e.target.alt),q(!0)}),[]),V=Object(a.useCallback)((function(){K()&&p()({method:"post",url:"/post/remove",params:{postId:t.data.id,userId:J.id},withCredentials:!0}).then((function(e){console.log("postRemove result",e),201===e.status?(w.a.success(e.data),U({type:y.p,payload:{id:t.data.id,userId:J.id}})):w.a.warning(e.data)})).catch((function(e){console.error("😡 ",e)}))}),[U,K,t.data.id,J.id]),W=Object(a.useCallback)((function(){K()&&f(!0!==m)}),[K,m]),X=Object(a.useCallback)((function(){K()&&O(!0!==h)}),[h,K]),Y=Object(a.useCallback)((function(){p()({method:"post",url:"/post/user/following",withCredentials:!0,params:{userId:J.id,targetUserId:t.data.userId}}).then((function(e){200===e.status?w.a.success("following success! 🐳"):w.a.warning(e.data),console.log("following state check",e)})).catch((function(e){console.error("😡 ",e)}))}),[t.data.userId,J.id]),Z=Object(a.useCallback)((function(){p()({method:"post",url:"/post/user/scrap",withCredentials:!0,params:{userId:J.id,postId:t.data.id}}).then((function(e){200===e.status?w.a.success("scrap success! 🐳"):w.a.warning(e.data),console.log("scrap state check",e)})).catch((function(e){console.error("😡 ",e)}))}),[t.data.id,J.id]);return r.a.createElement(P.a,{style:{display:"flex",flex:1,alignItems:"center",justifyContent:"center"}},r.a.createElement(P.a,{style:{width:400},cover:t.data.images[0]&&r.a.createElement(r.a.Fragment,null,t.data.images.map((function(e){return _.push("../../public/images/".concat(e.filename)),r.a.createElement("img",{src:"../../public/images/".concat(e.filename),onClick:Q,alt:_.length-1})})),A&&r.a.createElement(d.a,{mainSrc:_[k],onCloseRequest:function(){return q(!1)},nextSrc:_[(k+1)%_.length],prevSrc:_[(k+_.length-1)%_.length],onMovePrevRequest:function(){return C((k+_.length-1)%_.length)},onMoveNextRequest:function(){return C((k+1)%_.length)}})),actions:[r.a.createElement(S.a,{key:"topLeft",content:"change 🐳",arrowPointAtCenter:!0,onClick:W},r.a.createElement(l.a,{key:"edit"})),r.a.createElement(S.a,{key:"topLeft",content:"comment 🐳",arrowPointAtCenter:!0,onClick:X},r.a.createElement(s.a,{key:"comment"})),r.a.createElement(S.a,{key:"ellipsis",content:J&&J.id?r.a.createElement(r.a.Fragment,null,J.id===t.data.userId?r.a.createElement(b.a,null,r.a.createElement(v.a,{Button:!0,danger:!0,onClick:V},"remove"),r.a.createElement(v.a,{Button:!0,type:"primary",ghost:!0,onClick:Z},"scrap")):null,J.id!==t.data.userId?r.a.createElement(b.a,null,r.a.createElement(v.a,{Button:!0,type:"primary",ghost:!0,onClick:Y},"following"),r.a.createElement(v.a,{Button:!0,type:"primary",ghost:!0,onClick:Z},"scrap")):null):"Login please! 🐳"},r.a.createElement(i.a,{key:"ellipsis"}))]},r.a.createElement(L,{avatar:t.data.user.images[0]&&void 0!==t.data.user.images[0].filename?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{src:"../../public/images/".concat(t.data.user.images[0].filename),alt:"Han Solo",onClick:function(){return T(!0)}}),z&&r.a.createElement(d.a,{reactModalStyle:{overlay:{},content:{}},mainSrc:"../../public/images/".concat(t.data.user.images[0].filename),onCloseRequest:function(){return T(!1)}})):r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{icon:r.a.createElement(u.a,null)})),title:t.data.title.split(" ").map((function(e){return"#"===e.charAt(0)?r.a.createElement("span",{style:{color:"#3399ff",cursor:"pointer"},onClick:function(){G(e.slice(1))}},e," "):r.a.createElement("span",null,e," ")}))}),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"inline-block",width:"340px",float:"left",wordBreak:"break-all"}},t.data.content.split(" ").map((function(e){return"#"===e.charAt(0)?r.a.createElement("span",{style:{color:"#3399ff",cursor:"pointer"},onClick:function(){G(e.slice(1))}},e," "):r.a.createElement("span",null,e," ")})))),h&&r.a.createElement(D,{post:t.data}),m&&r.a.createElement(R,{post:t.data}),t.data.comments[0]&&t.data.comments.forEach((function(e){var n=t.data.comments.length-1;null===N||e.group===N.group&&e.id!==t.data.comments[n].id?null===N?((N=x({},e)).comments=[],n||$.push(N)):N.comments.push(e):(N.comments.length>0?(e.id===t.data.comments[n].id&&e.group===N.group&&N.comments.push(e),N.comments.push(x({},N.comments[N.comments.length-1],{depth:N.comments[0].depth})),$.push(N),e.id===t.data.comments[n].id&&e.group!==N.group&&$.push(x({},e,{comments:[]}))):e.id===t.data.comments[n].id?e.group===N.group?(N.comments.push(e),N.comments.push(x({},N.comments[N.comments.length-1],{depth:N.comments[0].depth})),$.push(N)):($.push(N),$.push(x({},e,{comments:[]}))):$.push(N),(N=x({},e)).comments=[])})),t.data.comments[0]&&$.map((function(e){return r.a.createElement(F,{post:t.data,comment:e})})))};z.propTypes={post:g.a.object},t.default=z}}]);