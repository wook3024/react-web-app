(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{669:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),c=n(48),r=n(29),s=n(56),i=n.n(s),l=n(692),m=n(693),u=n(694),d=n(695),p=n(682),f=n(21),h=n.n(f),b=n(344),g=n(1),y=n.n(g),O=n(4),k=n(673),j=n.n(k),w=n(100),E=n.n(w),v=n(358),I=n.n(v),C=n(94),S=n.n(C),P=n(301),R=n.n(P),A=n(312),D=n.n(A),x=n(54),M=n.n(x);n(670),n(146),n(346),n(141),n(300),n(305),n(140);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,a=!1,c=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){a=!0,c=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var F=Object(o.lazy)((function(){return n.e(18).then(n.bind(null,399))})),J=R.a.TextArea,L=function e(t){var n=t.post,s=t.comment,f=N(Object(o.useState)(0),2),g=f[0],y=f[1],k=N(Object(o.useState)(!1),2),w=k[0],v=k[1],C=N(Object(o.useState)(0),2),P=C[0],R=C[1],A=N(Object(o.useState)(!1),2),x=A[0],T=A[1],H=N(Object(o.useState)(!1),2),q=H[0],L=H[1],U=N(Object(o.useState)(""),2),V=U[0],z=U[1],$=N(Object(o.useState)(!1),2),_=$[0],B=$[1],G=N(Object(o.useState)(!1),2),K=G[0],Q=G[1],W=Object(o.useRef)(null),X=Object(c.c)((function(e){return e})).userInfo,Z=Object(c.b)(),ee=Object(r.f)(),te=null,ne=[],oe=s.likes.length+g,ae=s.dislikes.length+P,ce=0;Object(o.useEffect)((function(){h()({method:"post",url:"/post/comment/likeState",params:{userId:X.id,commentId:s.id},withCredentials:!0}).then((function(e){!0===e.data&&v(!0)})).catch((function(e){console.error("ðŸ˜¡ ",e)})),h()({method:"post",url:"/post/comment/dislikeState",params:{userId:X.id,commentId:s.id},withCredentials:!0}).then((function(e){!0===e.data&&T(!0)})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}),[]),Object(o.useEffect)((function(){B(!1)}),[s.comments.length]);var re=function(e){return console.log("likeCheck",e),201!==e.status?(S.a.warning(e.data),!1):(ce="unLike"===e.data?-1:1,!0)},se=Object(o.useCallback)((function(e){console.log("hashtag: ",e),Z({type:O.m}),Z({type:O.q,payload:{hashtag:e}}),window.scrollTo(0,0),ee.push("/hashtag")}),[]),ie=Object(o.useCallback)((function(){h()({method:"post",url:"/post/comment/like",params:{commentId:s.id,postId:n.id},withCredentials:!0}).then((function(e){re(e)&&(y(0===g?ce:0),v(!w))})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}),[s.id,re,w,g,ce,n.id]),le=Object(o.useCallback)((function(){h()({method:"post",url:"/post/comment/dislike",params:{commentId:s.id,postId:n.id},withCredentials:!0}).then((function(e){re(e)&&(R(0===P?ce:0),T(!x))})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}),[s.id,x,P,re,ce,n.id]),me=Object(o.useCallback)((function(){console.log("comment Set check",s),console.log("commentRemoveCheck"),h()({method:"post",url:"/post/comment/remove",params:{commentId:s.id,postId:n.id,group:s.group,sort:s.sort,force:!1},withCredentials:!0}).then((function(e){console.log("commentRemove response",e,s.id,s.postId),201===e.status?S.a.success(e.data):S.a.warning(e.data),s.comments.forEach((function(e){h()({method:"post",url:"/post/comment/remove",params:{commentId:e.id,postId:n.id,group:e.group,sort:e.sort,force:!0},withCredentials:!0}).then((function(t){console.log("commentRemove response",t,e.id,e.postId),h()({method:"get",url:"/post/comment",params:{postId:n.id}}).then((function(e){console.log("comments data check",e),Z({type:O.d,payload:{postId:n.id,comments:e.data}})}))})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}))})).then((function(e){console.log("res check",e),Z({type:O.b,payload:{commentId:s.id,postId:s.postId}})})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}),[s,Z,n.id]),ue=Object(o.useCallback)((function(e){z(e.target.value),console.log("commentValue",V)}),[V]),de=Object(o.useCallback)((function(){if(L(!1),""===V.trim())return S.a.warning("Please include the contents.! ðŸ˜±");h()({method:"post",url:"/post/comment/change",withCredentials:!0,params:{commentId:s.id,comment:V.trimRight(),postId:n.id}}).then((function(e){if(console.log("commnetUpdateResponse",e),201!==e.status)return S.a.warning(e.data);S.a.success(e.data),Z({type:O.c,payload:{commentId:s.id,postId:s.postId,comment:V.trimRight()}})})).catch((function(e){console.error("ðŸ˜¡ ",e)}))}),[s.id,s.postId,V,Z,n.id]),pe=Object(o.useCallback)((function(){return[a.a.createElement("span",{key:"comment-basic-like"},a.a.createElement(E.a,{title:"Like"},Object(o.createElement)(!0===w?l.a:m.a,{onClick:ie})),a.a.createElement("span",{className:"comment-action"},oe)),a.a.createElement("span",{key:' key="comment-basic-dislike"'},a.a.createElement(E.a,{title:"Dislike"},a.a.createElement(!0===x?u.a:d.a,{onClick:le})),a.a.createElement("span",{className:"comment-action"},ae)),a.a.createElement("span",{key:"comment-basic-reply-to",onClick:function(){return B(!_)}},X&&X.id?"Reply to":""),a.a.createElement("span",{key:"comment-basic-change",onClick:function(){return L(!q)}},X&&X.id===s.user.id?"Change":""),a.a.createElement("span",{key:"comment-basic-remove",onClick:me},X&&X.id===s.user.id?"Remove":"")]}),[q,s.user.id,me,le,ae,x,ie,oe,w,_,X]);return a.a.createElement(j.a,{style:{width:"300px",margin:"0 auto"},actions:pe(),author:s.user?s.user.nickname:"not found",avatar:s.user.images[0]&&void 0!==s.user.images[0].filename?a.a.createElement(a.a.Fragment,null,a.a.createElement(I.a,{src:"../../public/images/".concat(s.user.images[0].filename),alt:"Han Solo",onClick:function(){return Q(!0)}}),K&&a.a.createElement(b.a,{reactModalStyle:{overlay:{},content:{}},mainSrc:"./images/".concat(s.user.images[0].filename),onCloseRequest:function(){return Q(!1)}})):a.a.createElement(a.a.Fragment,null,a.a.createElement(I.a,{icon:a.a.createElement(p.a,null)})),content:q?a.a.createElement(D.a,null,a.a.createElement(J,{rows:4,style:{margin:"0 0 0.5rem 0",width:"300px",display:"block"},onChange:ue,ref:W,defaultValue:s.comment}),a.a.createElement(M.a,{type:"primary",onClick:de},"submit")):s.comment.split(" ").map((function(e){return"#"===e.charAt(0)?a.a.createElement("span",{style:{color:"#3399ff",cursor:"pointer"},onClick:function(){se(e.slice(1))}},e,"Â "):a.a.createElement("span",null,e,"Â ")})),datetime:a.a.createElement(E.a,{title:i()().format("YYYY-MM-DD HH:mm:ss")},a.a.createElement("span",null,i()(s.created_at).fromNow()))},_&&a.a.createElement(F,{post:n,comment:s}),s.comments[0]&&s.comments.forEach((function(e){var t=s.comments.length,n=te&&te.comments[0]?te.comments.length:0;null!==te&&e.depth<=s.depth+1?(n>0?(te.comments.push(Y({},te.comments[t-1],{depth:te.comments[0].depth})),ne.push(te),te=null):ne.push(te),(te=Y({},e)).comments=[]):null===te?(te=Y({},e)).comments=[]:te.comments.push(e)}))||ne.reverse().map((function(t){return a.a.createElement(e,{post:n,comment:t})})))};L.propTypes={post:y.a.object,comment:y.a.object},t.default=L}}]);