(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{685:function(e,n,t){"use strict";t.r(n);var o=t(0),c=t.n(o),l=t(48),r=t(21),i=t.n(r),u=t(4),a=(t(143),t(94)),d=t.n(a),s=(t(141),Object(o.lazy)((function(){return Promise.all([t.e(2),t.e(4),t.e(5),t.e(6)]).then(t.bind(null,342))}))),f=Object(o.lazy)((function(){return Promise.all([t.e(0),t.e(7)]).then(t.bind(null,343))})),m=Object(o.lazy)((function(){return Promise.all([t.e(0),t.e(1),t.e(3),t.e(8),t.e(11)]).then(t.bind(null,402))}));n.default=function(){var e=Object(l.c)((function(e){return e})),n=e.post,t=e.userInfo,r=Object(l.b)(),a=!1,p=[],h=void 0,w=function(){window.scrollY>document.documentElement.scrollHeight-document.documentElement.clientHeight-500&&!a&&p[0]&&p.map((function(e){return e.id===h}))&&(a=!0,console.log("getNewpost",p,p.length-1,p[p.length-1]),i()({method:"get",url:"/post",params:{id:p[0]?p[p.length-1].id:void 0}}).then((function(e){h=void 0===h?p[0].id:h,r({type:u.g,payload:{post:p=e.data}})})).then((function(){a=!1})).catch((function(e){console.error("üò° ",e)})))};return Object(o.useEffect)((function(){return window.addEventListener("scroll",w),function(){window.removeEventListener("scroll",w)}}),[]),Object(o.useEffect)((function(){p[0]!==n[0]&&(r({type:u.m}),p=[]),i()({method:"get",url:"/post",params:{id:p[0]?p[p.length-1].id:void 0}}).then((function(e){r({type:u.i,payload:{post:p=e.data}})})).then((function(){0===p.length&&d.a.warning("There are no posts üê≥")})).catch((function(e){console.error("üò° ",e)}))}),[]),c.a.createElement("div",null,c.a.createElement(f,null),t&&t.username&&c.a.createElement(m,null),n.map((function(e){return c.a.createElement(s,{key:e.created_at,post:{data:e}})})))}}}]);